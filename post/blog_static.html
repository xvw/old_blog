<!DOCTYPE html>
<html>
  <head>
    <title>xvw : G√©n√©rateurs de sites statiques</title>
		<link href='https://fonts.googleapis.com/css?family=Playfair+Display:400,400italic,700' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Droid+Sans:400,700' rel='stylesheet' type='text/css'>
<link href='../css/app.min.css' rel='stylesheet' type='text/css'>

		<link rel="stylesheet" href="../css/default.css">
    <meta charset="utf-8">
    <meta name='keywords' content='programmation,static,statique,site,blog,g„©n„©rateurs,hakyll,jekyll,nanoc'>
		<script src="../js/highlight.pack.js"></script>
		<script>hljs.initHighlightingOnLoad();</script>
  </head>
  <body>
    <div id="ui-notif" class="notif">
      <div>
      Cet article est ouvert √† la modification, correction orthographique
      [
      <a href="https://github.com/xvw/xvw.github.io/blob/master/raw/articles/blog_static.md">
        Voir sur Github
      </a>
      ]
      </div>
      <div id="close-alert" class="right-child">
        x
      </div>
    </div>
		<div id="content">
			<div id="header">
				<h1>G√©n√©rateurs de sites statiques</h1>
				<h2>Pistes d'impl√©mentation</h2>
			</div>
			<div class="center headmenu">
        <a href="../list.html#Encore-une-lecture?" title="Bonne lecture?">Retour √† la liste</a>
				<a href="../index.html#Pourquoi-ne-pas-laisser-un-petit-commentaire?!" title="Il y a des commentaires en bas !!!">Retour √† l'accueil</a>
			</div>
			<div id="article-content">
				<blockquote>
<p>J'administre la page <a href="http://atelier-prog.github.io/">atelier-prog</a> depuis quelques temps pour offrir des exercices vari√©s dans le monde de la programmation. J'ai r√©cemment eu l'occasion de proposer un article sur la cr√©ation d'un g√©n√©rateur de site statiques car je trouve que c'est un exercice relativement polyvalent (et que √ßa permet, √©ventuellement, √† stimuler la motivation des gens √† √©crire). On m'a tr√®s justement fait remarquer que j'√©tais tristement peu exhaustif sur &quot;ce qui est √† faire&quot; et j'ai d√©cid√© de r√©pondre √† ce manque d'exhaustivit√© en √©crivant un article sur le sujet.<br />Cet article ne pr√©sentera pas l'int√©gralit√© des g√©n√©rateurs, ni m√™me un didacticiel sur comment se servir d'un g√©n√©rateur en particulier. Je t√¢cherai de donner du haut de ma subjectivit√© une opinion sur le g√©n√©rateur de pages statiques, dans l'absolu, et √©ventuellement formuler quelques pistes d'impl√©mentation. Le sujet m'int√©resse assez, d'ailleur, cette page est elle m√™me issue d'un g√©n√©rateur maison qui maintient l'organisation de ce blog !</p>
</blockquote>
<h2 id="entre-les-pages-statiques-et-les-pages-dynamiques">Entre les pages statiques et les pages dynamiques</h2>
<p>Dans le monde de l'internet... il existe deux types de sites web. Les pages dynamiques et les pages statiques. Une page dynamique est une page qui est g√©n√©r√©e, par le serveur, au moment o√π l'utilisateur l'a demande. L'avantage est qu'il devient plus facile de cr√©er de l'interaction avec l'utilisateurs. Par exemple, en PHP:</p>
<pre class="sourceCode php"><code class="sourceCode php">&lt;h1&gt;Mon site&lt;/h1&gt;
&lt;span&gt;Il est : &lt;<span class="ot">?</span>php <span class="fu">echo</span> <span class="fu">date</span><span class="ot">(</span><span class="st">&#39;H:i&#39;</span><span class="ot">);</span> <span class="kw">?&gt;</span>&lt;/span&gt;</code></pre>
<p>Cette page renverra l'heure √† laquelle la page a √©t√© demand√©e par l'utilisateur. Dans un site statique, le serveur se contente de renvoyer invariablement la m√™me page.<br />Gr√¢ce aux sites web dynamiques, il a √©t√© possible de concevoir de l'interaction, et les applications ont pu commencer √† avoir un cycle de vie qui n'√©tait plus sp√©cialement contr√¥l√© par le webmaster.<br />Essayons d'imaginer un forum de discussion sans interaction possible. M√™me si l'on peut difficilement se passer, dans un web moderne, de dynamisme, je suis convaincu qu'il est parfois n√©c√©ssaire de s'interroger sur l'int√©r√™t d'utiliser l'artillerie lourde pour certaines pages. Par exemple un blog.<br />En effet, il arrive parfois que la majeure partie des modifications d'une page soient effectu√©es par le webmaster (c'est le cas de mon blog). Dans ce genre de contexte, il est int√©ressant de r√©fl√©chir √† l'usage d'un serveur servant un langage pour faire des pages dynamiques (comme PHP), donc plus complexe √† heberger qu'un simple serveur HTTP pour afficher du HTML simple.</p>
<blockquote>
<p>De mon point de vue, l'utilisation du mot &quot;dynamique&quot; est devenu un peu flou, √©tant donn√©e la popularit√© du JavaScript, qui introduit une notion de dynamisme dans les pages, mais c'est un autre d√©bat.</p>
</blockquote>
<p>Certains se diront que m√™me pour une page personnelle ne n√©c√©ssitant pas d'interaction utilisateur, une technologie servant des pages dynamiques est un √©norme plus car on automatise les rendus des pages. L'enjeu de cet article est donc de pr√©senter comment automatiser son fl√¥t de publication au moyen d'un g√©n√©rateur de pages statiques.</p>
<h3 id="comparatif-entre-les-pages-dynamiques-et-statiques">Comparatif entre les pages dynamiques et statiques</h3>
<p>Ce tableau est √©videmment √† prendre dans un contexte pertinent. Je r√©p√®te qu'√† mon sens, les deux types de sites ont chacun leurs avantages et inconv√©nient et bien √©videmment leurs domaines d'expertises.</p>
<table>
<thead>
<tr class="header">
<th align="left">Dynamiques</th>
<th align="left">Statiques</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Plus compliqu√© √† heberger</td>
<td align="left">Extr√®mement simple √† heberger (surtout depuis les github-pages)</td>
</tr>
<tr class="even">
<td align="left">Interaction possible avec l'utilisateur</td>
<td align="left">Oblig√© de passer par un service tierce pour modeliser les interactions</td>
</tr>
<tr class="odd">
<td align="left">Compliqu√© (et co√ªteux) de faire des g√©n√©rations overkill (conversion de Markdown, g√©n√©ration de diagrammes, PDF)</td>
<td align="left">Total libert√© de g√©n√©ration</td>
</tr>
<tr class="even">
<td align="left">Complexe √† s√©curiser correctement</td>
<td align="left">Que des pages statiques donc aucune faille (en dehors de celles du serveur)</td>
</tr>
<tr class="odd">
<td align="left">D√©pendance d'un cadriciel web</td>
<td align="left">Libert√© du langage</td>
</tr>
</tbody>
</table>
<h3 id="mon-blog-est-un-site-statique">Mon blog est un site statique</h3>
<p>Pour mon cas, j'avais imp√©rativement besoin d'un site facile √† heberger (sur les <a href="https://pages.github.com/">github-pages</a>, pour ne pas m'encombrer d'un serveur HTTP, FTP etc. et les github-pages ne servent <em>que</em> des sites statiques.<br />De plus, je voulais pouvoir √©crire mes articles en <a href="https://fr.wikipedia.org/wiki/Markdown">Markdown</a> et id√©alement √©crire mon <em>moteur de blog</em> en <a href="http://ocaml.org">OCaml</a> (parce que c'est un langage que j'adore). J'ai donc √©crit un logiciel g√©n√©rant les diff√©rentes pages de mon site web et dont la construction/mise √† jour des pages est r√©gie par plusieurs petits logiciels OCaml et d√©ploy√© au moyen d'un Makefile et de Git.</p>
<p>Le principal point faible d'un g√©n√©rateur de site statique porte sur les commentaires. Heureusement, il existe beaucoup de syst√®mes d√©localis√©s (comme <a href="http://disqus.com">Disqus</a> que j'utilise) que nous √©voquerons plus tard dans cet article.</p>
<h2 id="fonctionnement-dun-g√©n√©rateur-de-sites-statiques">Fonctionnement d'un g√©n√©rateur de sites statiques</h2>
<p>Comme il l'a √©t√© √©voqu√© plus haut, un g√©n√©rateur n'est rien de plus qu'un logiciel (ou une collection de logiciels) qui offre les outils n√©c√©ssaire √† l'automatisation de la construction du site localement et √©ventuellement √† son d√©ployement.</p>
<div class="figure">
<img src="../images/static-flow.png" />
</div>
<p>Donc plut√¥t que de laisser au serveur la t√¢che de g√©n√©rer √† la demande toute la hi√©rarchie logique du site, on cr√©e une version statique d'une collection de fichiers locaux que l'on d√©ploye.<br />Pour ma part, dans ce syst√®me de blog (qui devra √™tre revu un jour), j'utilise des donn√©es brutes qui configurent (en XML) la description formelle d'une page. Voici par exemple le fichier de description de cet article :</p>
<pre class="sourceCode xml"><code class="sourceCode xml"><span class="er">&lt;</span>title&gt;Les g√©n√©rateurs de sites statiques<span class="er">&lt;</span>/title&gt;
<span class="er">&lt;</span>subtitle&gt;Pr√©sentation et pistes d&#39;impl√©mentation<span class="er">&lt;</span>/subtitle&gt;
<span class="er">&lt;</span>desc&gt;Pr√©sentation sommaire de ce que sont les g√©n√©rateurs de sites statiques,
ainsi qu&#39;une consid√©ration sur une mani√®re d&#39;en impl√©menter un.<span class="er">&lt;</span>/desc&gt;
<span class="er">&lt;</span>keywords&gt;programmation, static, statique, site, blog, g√©n√©rateurs, hakyll,
jekyll, nanoc<span class="er">&lt;</span>/keywords&gt;
<span class="kw">&lt;date&gt;</span>03/09/2015<span class="kw">&lt;/date&gt;</span>
<span class="kw">&lt;file&gt;</span>raw/articles/blog_static.md<span class="kw">&lt;/file&gt;</span>
<span class="kw">&lt;draft/&gt;</span></code></pre>
<p>Au moment o√π j'√©cris ces mots, l'article est encore en brouillon, ce qui explique la pr√©sence de la balise <code>&lt;draft /&gt;</code>. Cette description r√©f√©rence l'article qui est √©crit en Markdown et au moment de la g√©n√©ration, le syst√®me compresse le HTML et le CSS, g√©n√®re les fichiers HTML compress√© des articles, g√©n√®re un PDF pour l'article, construit l'index et le flux RSS et il ne me reste plus qu'a d√©ployer.</p>
<p>Gr√¢ce √† cette m√©thode, pour peu que l'ordinateur poss√®de Git (et... les d√©pendance que j'ai avec OCaml, Pandoc et LaTeX, que tout d√©veloppeur DOIT poss√©der :) ), je peux modifier mon blog de partout, en clonant localement le projet et en ajoutant/modifiant des fichiers.</p>
<h3 id="quelques-solutions-√©prouv√©es">Quelques solutions √©prouv√©es</h3>
<p>Les blogs statiques √©tant de plus en plus populaire, voici une liste non exhaustive des solutions que j'ai pu survoler :</p>
<ul>
<li><a href="https://zoggy.github.io/stog/">Stog</a> : un syst√®me √©crit en OCaml avec une multitude d'outil;</li>
<li><a href="https://middlemanapp.com/">Middleman</a> : le chouchou des programmeurs ruby que je connais;</li>
<li><a href="http://jaspervdj.be/hakyll/">Hakyll</a> : le g√©n√©rateur de g√©n√©rateur de blog statique √©crit en Haskell;</li>
<li><a href="http://jekyllrb.com/">Jekyll</a> : une solution ruby d√©velopp√© par un des cr√©ateurs de Github;</li>
<li><a href="http://nanoc.ws/">nanoc</a> : encore une solution ruby;</li>
<li><a href="http://blog.getpelican.com/">pelican</a> : un g√©n√©rateur en python.</li>
</ul>
<p>Il existe √©videmment pl√©thore d'autre solution, et je n'ai pas vraiment l'envie de faire un comparatif de ces solutions (il en existe s√ªrement d√©j√† √©norm√©ment sur le net!). Donc si vous ne voulez pas coder votre propre outil (parce que contrairement √† moi, vous n'aimez pas r√©inventer la roue... snif), je vous invite √† vous faire votre propre opinion sur la question :)<br /><a href="https://www.staticgen.com/">Ce site</a> liste les g√©n√©rateurs les plus populaires.</p>
<h2 id="pistes-pour-limpl√©mentation-dun-g√©n√©rateur">Pistes pour l'impl√©mentation d'un g√©n√©rateur</h2>
<p>Dans cette rubrique, nous allons voir quelques pistes pour impl√©menter son propre g√©n√©rateur de pages statiques. Sans tomber dans <em>l'over-engineering</em> et sans √™tre hypocrite (en ne proposant rien de g√©n√©r√©).<br />Sans proposer une impl√©mentation, je proposerai ce qui selon moi est la structure minimale d'un g√©n√©rateur, et comment √©viter certaines probl√©matiques ennuyantes.<br />Bien que la construction d'un g√©n√©rateur puisse sembler assez simple, un lot de probl√©matiques peut rapidement faire intrusion si le syst√®me n'a pas √©t√© m√ªrement r√©fl√©chit √† sa source, de plus, il ne faut pas h√©siter √† utiliser les nombreux outils mis √† disposition. (J'aime r√©inventer la roue, mais il ne faut pas exag√©rer !)</p>
<h3 id="les-ingr√©dients">Les ingr√©dients</h3>
<p>M√™me si les avis diff√®re sur ce que doit proposer un g√©n√©rateur de sites statiques, voici de mon point de vue ce qu'il est n√©c√©ssaire d'avoir pour offrir un g√©n√©rateur agr√©able √† utiliser:</p>
<ul>
<li>Un format de r√©daction (personnellement, j'utilise Markdown);</li>
<li>un convertisseur du format vers du HTML;</li>
<li>un outil de description minimale;</li>
<li>un outil pour int√©grer les pages g√©n√©r√©es dans un gabarit;</li>
<li>un g√©n√©rateur de liste de publications (dans le cas d'un blog).</li>
</ul>
<p>Dans l'absolu, je ne pense pas qu'il soit n√©c√©ssaire d'avoir plus. L'id√©e g√©n√©rale √† cette √©num√©ration est de permettre √† l'utilisateur du g√©n√©rateur ( en l'occurence... nous), d'√©crire un article dans un format de texte qui lui pla√Æt (personnellement, j'ai en horreur le BBcode), de lancer le g√©n√©rateur qui va construire une liste en utilisant la description des articles.</p>
<h3 id="outils">Outils</h3>
<p>La liste des outils pr√©sente, en outre, une ou plusieurs probl√©matiques li√©es √† la construction d'un g√©n√©rateur de sites statiques.</p>
<h4 id="pandoc-conversion-de-textes">Pandoc: conversion de textes</h4>
<p><a href="http://pandoc.org/">Pandoc</a> est un convertisseur de textes compl√®tement overkill qui peut convertir <a href="http://pandoc.org/diagram.jpg">√©norm√©ment de formats en √©norm√©ments de formats</a>.<br />Je pense qu'un des points compliqu√© dans l'√©criture d'un g√©n√©rateur de pages statiques est la construction d'un convertisseur de texte (dans mon cas, pour aller de Markdown vers HTML et PDF). Je me sers de Pandoc pour rendre cette t√¢che aussi simple qu'un simple appel de ligne de commande. L'outil est tr√®s riche et bien document√© (et √©crit en Haskell). Je le recommande !</p>
<h4 id="github-d√©ployement-facile">Github: d√©ployement facile</h4>
<p>M√™me s'il est toujours possible de d√©ployer manuellement son site web, c'est assez ennuyeux quand on est actif sur sa page. Une solution (utilis√©e par <a href="https://github.com/Grimimi">Grim</a>) est l'impl√©mentation d'un client FTP pour automatiser le d√©ployement, cependant, m√™me si l'exercice est int√©ressant, c'est tout de m√™me beaucoup de travail.<br />Depuis un petit temps, <a href="http://github.com">Github</a> offre un service d'hebergement de pages statiques (sur un projet pr√©cis ou sur une branche orpheline). D√©ployer son application devient donc extr√®mement simple, il suffit de faire un <code>git push</code>.</p>
<h4 id="disqus-les-commentaires">Disqus: les commentaires</h4>
<p>La teneur statique du site ne permet pas de faire du dynamisme. Pour un blog, le gros point ennuyant est qu'il devient &quot;nativement&quot; impossible d'ajouter un syst√®me de commentaires. Il existe beaucoup de services qui permettent d'installer des commentaires sur une page statique au moyen d'une petite ligne JavaScript tr√®s courte. Personnellement, j'ai pris l'habitude de me servir de <a href="http://disqus.com">Disqus</a> qui agr√®ge une communaut√© d'une certaine taille dans le monde des blogs de programmation et qui s'int√®gre tr√®s facilement dans une page (de plus, on ne doit pas se soucier de param√©trer la page, le service s'en charge tout seul).<br />Il suffit donc de pr√©voir dans son gabarit destin√© aux pages commentables, l'int√©gration de la portion de code n√©c√©ssaire √† l'embarquement des commentaires.</p>
<h4 id="tup-calcul-des-d√©pendances">Tup: calcul des d√©pendances</h4>
<p>Un site statique est amen√© √† √™tre reg√©n√©r√© √† chaque modification. Le calcul de ce qui est n√©c√©ssaire √† reg√©n√©rer est bien plus complexe qu'il n'y parait. En effet, dans la majeure partie des cas, consulter la date de modification du fichier suffit, mais il existe des cas plus fourbes, comme par exemple lorsque le g√©n√©rateur poss√®de un syst√®me de tags apparents et qu'un tag est modifie, ce qui implique la modification de toutes les pages r√©f√©renc√©es par ce tag.<br />Bien que je ne m'en sois jamais servi, il parait que <a href="http://gittup.org/tup/">Tup</a> est un bon outil pour calculer efficacement ces d√©pendances.</p>
<h4 id="synth√®ses-des-outils">Synth√®ses des outils</h4>
<p>Pour terminer la liste des outils, voici une micro-synth√®se (un peu enrichie) de solutions. Tup ne sera pas reprise car c'est un outil qui r√©pond √† un besoin un peu trop sp√©cifique et ne concerne que les syst√®mes de blogs avanc√©s.</p>
<p><strong>Hebergement</strong></p>
<ul>
<li><a href="https://pages.github.com/">Github page</a>, ma solution favorite;</li>
<li><a href="https://dropbox.com">Dropbox</a> (lol);</li>
<li><a href="https://www.site44.com/">Site44</a>, une solution d'hebergement extra-simple;</li>
<li><a href="https://www.kissr.com/">KISSr</a>, une abstraction sur Dropbox.</li>
</ul>
<p><strong>Convertisseurs de textes</strong></p>
<p>Je ne connais que <a href="http://pandoc.org/">Pandoc</a> que je re-recommande !</p>
<p><strong>Commentaires embarqu√©s</strong></p>
<ul>
<li><a href="https://disqus.com/">Disqus</a>, le syst√®me que j'utilise;</li>
<li><a href="http://posativ.org/isso/">Isso</a>, un outil libre (similaire √† Disqus).</li>
</ul>
<p><strong>Analyses</strong></p>
<ul>
<li><a href="https://www.google.com/intl/fr_fr/analytics/">Google Analytics</a>, pusique Google sait d√©j√† tout de nous;</li>
<li><a href="https://fr.piwik.org/">Piwik</a>, une alternative libre !</li>
</ul>
<h3 id="le-javascript-√†-la-rescousse">Le JavaScript √† la rescousse</h3>
<p>M√™me si je ne suis pas f√©ru de l'usage absolument immod√©r√© du JavaScript, ce dernier offre tout de m√™me des raccourcis ind√©niables ! Je pense que g√©n√©r√© une partie acceptable de donn√©es JSon peut √™tre une solution &quot;simple&quot; pour faciliter l'indexation (et le probl√®mes des tags). De plus, le Javascript permet facilement de mettre en place de petites choses qui agr√©mentent la navigation, comme par exemple, la barre de recherche pr√©sente sur la liste des publications de mon blog.</p>
<h2 id="conclusion">Conclusion</h2>
<p>J'esp√®re que ce bref article aura motiv√© certaines personnes int√©ress√©e par l'atelier <a href="http://atelier-prog.github.io/topics/blogstatic.html">cr√©er son blog statique</a> et que √©ventuellement, nous verrons <strong>pleins</strong> de g√©n√©rateurs na√Ætrent. Et donc en plus, id√©alement, pleins de blogs na√Ætrent. Si par malheur vous ne savez pas sur quoi √©crire, vous pourrez toujours r√©diger un premier article qui explique comment vous avez r√©ussi √† faire votre propre g√©n√©rateur de blogs statiques ! Pour ma part, je pense me relancer dans le d√©veloppement de <a href="https://github.com/xvw/piplet">piplet</a> lorsque je ne serai plus trop pris par mon travail. Merci de votre lecture !</p>

			</div>
			
			<div class="comment_box">
				<h2>Commentaires</h2>
				  <div id="disqus_thread"></div>
					<script type="text/javascript">
						/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
						var disqus_shortname = 'nukifw'; // required: replace example with your forum shortname
						
						/* * * DON'T EDIT BELOW THIS LINE * * */
						(function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
						})();
					</script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
			</div>

		</div>
		<div id="header-line"></div>
    <script src="../js/articlejs.js"></script>
	</body>
</html>
